FROM nginx:latest

# Create staticfiles directory with correct permissions
RUN mkdir -p /staticfiles && chown nginx:nginx /staticfiles

# Add proxy_params
COPY proxy_params /etc/nginx/

# Copy config and static files
COPY nginx.conf /etc/nginx/conf.d/default.conf
COPY --chown=nginx:nginx staticfiles/ /staticfiles/

EXPOSE 80
CMD ["nginx", "-g", "daemon off;"]